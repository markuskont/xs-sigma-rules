author: Florian Roth
category: proxy
date: 2017/07/08
description: Detects suspicious user agent strings used by malware in proxy logs
detection:
  condition: selection
  selection:
    http.http_user_agent:
    - '*<|>*'
    - nsis_inetc (mozilla)
    - '*zeroup*'
    - '* adlib/*'
    - '* tiny'
    - '* BGroom *'
    - '* changhuatong'
    - '* CholTBAgent'
    - backdoorbot
    - '*(Charon; Inferno)'
    - '* pxyscand*'
    - '* asd'
    - '* mdms'
    - sample
    - nocase
    - '*Microsoft Internet Explorer*'
    - agent *
    - winlog.event_data.Mozilla/5.0 (Windows NT 6.1; WOW64; rv:53.0) Gecko/20100101
      Chrome /53.0
    - winlog.event_data.Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1)
    - winlog.event_data.Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; Trident/4.0)
    - winlog.event_data.Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0; .NET CLR  1.1.4322)
    - winlog.event_data.HttpBrowser/1.0
    - winlog.event_data.Wget/1.9+cvs-stable (Red Hat modified)
    - winlog.event_data.Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; Trident/4.0;
      .NET CLR 1.1.4322)
    - winlog.event_data.Mozilla/5.0 (Windows NT 5.1 ; v.*
    - winlog.event_data.Mozilla/5.0 WinInet
    - winlog.event_data.RookIE/1.0
    - winlog.event_data.M
    - winlog.event_data.Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1; Trident/4.0)
    - winlog.event_data.Mozilla/4.0 (compatible;MSIE 7.0;Windows NT 6.0)
    - winlog.event_data.Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.9.2.3)
      Gecko/20100401 Firefox/3.6.1 (.NET CLR 3.5.30731)
    - winlog.event_data.Opera/8.81 (Windows NT 6.0; U; en)
    - winlog.event_data.Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.9.2.3)
      Gecko/20100401 Firefox/3.6.1 (.NET CLR 3.5.30729)
    - winlog.event_data.Opera
    - winlog.event_data.Mozilla/4.0 (compatible; MSIE 5.0; Windows 98)
    - winlog.event_data.Mozilla/4.0 (compatible; MSIE 5.01; Windows NT 5.0)
    - winlog.event_data.MSIE
    - winlog.event_data.Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1; Trident/5.0)
    - winlog.event_data.Mozilla/4.0 (compatible; MSIE 6.1; Windows NT)
    - winlog.event_data.Mozilla/4.0(compatible; MSIE 6.0; Windows NT 5.1)
    - winlog.event_data.Mozilla/5.0 (Windows NT 10.0; Win64; x64)
    - winlog.event_data.Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 10.0; Win64;
      x64)
    - winlog.event_data.Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; Win64;
      x64)
    - winlog.event_data.Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.2; WOW64;
      Trident/7.0; .NET4.0C; .NET4.0E; InfoPath.3)
    - winlog.event_data.Moxilla
    - winlog.event_data.Win32 *
    - winlog.event_data.AutoIt
    - winlog.event_data.IczelionDownLoad
falsepositives:
- Unknown
fields:
- src_ip
- http.url
- http.http_user_agent
id: 5c84856b-55a5-45f1-826f-13f37250cf4e
level: high
logsource:
  category: proxy
  product: suricata
  service: http
modified: 2020/09/03
product: suricata
references:
- http://rules.emergingthreats.net/open/snort-2.9.0/rules/emerging-user_agents.rules
- http://www.botopedia.org/search?searchword=scan&searchphrase=all
- https://networkraptor.blogspot.com/2015/01/user-agent-strings.html
- https://perishablepress.com/blacklist/ua-2013.txt
- https://www.bluecoat.com/en-gb/security-blog/2015-05-05/know-your-agents
service: http
status: experimental
tags:
- attack.command_and_control
- attack.t1071.001
title: Malware User Agent
