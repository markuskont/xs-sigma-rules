author: Margaritis Dimitrios (idea), Florian Roth (rule)
category: process_creation
date: 2019/01/16
description: Detects wscript/cscript executions of scripts located in user directories
detection:
  condition: selection and not falsepositive
  falsepositive:
    winlog.event_data.ParentImage,: '*\winzip*'
  selection:
    winlog.event_data.CommandLine,:
    - '* C:\Users\\*.jse *'
    - '* C:\Users\\*.vbe *'
    - '* C:\Users\\*.js *'
    - '* C:\Users\\*.vba *'
    - '* C:\Users\\*.vbs *'
    - '* C:\ProgramData\\*.jse *'
    - '* C:\ProgramData\\*.vbe *'
    - '* C:\ProgramData\\*.js *'
    - '* C:\ProgramData\\*.vba *'
    - '* C:\ProgramData\\*.vbs *'
    winlog.event_data.Image,:
    - '*\wscript.exe'
    - '*\cscript.exe'
falsepositives:
- Winzip
- Other self-extractors
fields:
- winlog.event_data.CommandLine,
- winlog.event_data.ParentCommandLine,
id: cea72823-df4d-4567-950c-0b579eaf0846
level: high
logsource:
  category: process_creation
  product: windows
modified: 2020/09/01
product: windows
status: experimental
tags:
- attack.execution
- attack.t1059.005
- attack.t1059.007
- attack.defense_evasion
- attack.t1064
title: WScript or CScript Dropper
